<!-- TOC -->

- [1. Gns3の導入方法](#1-gns3の導入方法)
  - [1.1. 目的](#11-目的)
  - [1.2. 必要なもの](#12-必要なもの)
  - [1.3. IOSイメージをダウンロードしてみよう！](#13-iosイメージをダウンロードしてみよう)

<!-- /TOC -->
# 1. Gns3の導入方法

## 1.1. 目的

GNS3の導入のために必要なことを示す。また今回は必要なIOS
イメージをCiscoルータからダウンロードする方針をとった。

## 1.2. 必要なもの

- MacPC
- Cisco2650XM（2600シリーズはできない機種もあるのでこれがおすすめ）
- LANケーブル
- LANポート TypeC変換ケーブル
- USBシリアル変換ケーブル(UGREEN USBが検証済み)
- ロールオーバーケーブル

## 1.3. IOSイメージをダウンロードしてみよう！

![](images/2021-08-03-17-34-32.png)

![](images/2021-08-03-17-35-12.png)

1. 上記のCONSOLEとFastEthernet0/0に、ロールオーバーケーブルとLANケーブルをそれぞれ繋げ、Macと接続する
2. ルーターに電源ケーブルを繋げる
3. パソコンの電源をつける
4. USBデバイスドライバをインストールする
[UGREENのドライバインストール](https://www.ugreen.com/)
5. インストールしたUSBドライバを確認する
   
```cs
$ls -l /dev/tty.*
```

成功したら以下が現れる

```cs
crw-rw-rw-  1 root  wheel   18,   4  7 30 21:41 /dev/tty.usbserial
```
人によって異なるので、.usebsirialと書かれている行をコピーする

6. screenコマンドを入れる

```cs
$ screen /dev/tty.usbserial
```
５でコピーした行をscreenコマンドの後に入れる

7. ルーターの電源を入れる

```cs
Last login: Tue Jul 30 21:41:57 on ttys000
XXXXXXXX-no-MacBook:~ XXXXXXXX$ screen /dev/tty.usbserial

〜〜〜〜〜〜〜〜〜〜〜
中略
〜〜〜〜〜〜〜〜〜〜〜
Initializing ATA monitor library.......

program load complete, entry point: 0x80012000, size: 0x1c2dee4
Self decompressing the image : ############################################################################################################################################################################################################################################################################ [OK]

              Restricted Rights Legend

Use, duplication, or disclosure by the Government is
subject to restrictions as set forth in subparagraph
(c) of the Commercial Computer Software - Restricted
Rights clause at FAR sec. 52.227-19 and subparagraph
(c) (1) (ii) of the Rights in Technical Data and Computer
Software clause at DFARS sec. 252.227-7013.

           cisco Systems, Inc.
           170 West Tasman Drive
           San Jose, California 95134-1706

```

上記のような文字が流れる
初めて起動したとき、Yes/Noを聞かれるがNoでOK

8. Macで別のターミナル（以下ターミナル２と記載する）を立ち上げて、以下のコマンドを入力しTFTPサーバを起動する

```cs
sudo launchctl load -w /System/Library/LaunchDaemons/tftp.plist
```

9. ターミナルにて以下のコマンドを入力する

```cs
Router>enable
Router#show flash
```
表示された

```cs
c2600-adventerprisek9-mz.124-25d.bin
```
で表示されるファイル名をコピーする

10. ターミナル２にて、以下のコマンドを入力する

```cs
% cd /private/tftpboot
% touch ./c2600-adventerprisek9-mz.124-25d.bin
% chmod 666 ./c2600-adventerprisek9-mz.124-25d.bin
```

11. ターミナルにて以下のコマンドを入力する

```cs
Router#conf t
Router(config)#interface FastEthernet 0/0
Router(config-if)#no shutdown
Router(config-if)#end
```

12. Macのシステム環境、ネットワークからUSBに割り当てられたIPアドレス、サブネットマスクを確認する

- 以下ではMacのIPアドレス192.255.255.3,サブネット255.255.255.0として進める

13. ターミナルにて以下のコマンドを入力する

```cs
Router#conf t
Router(config)#no service config
Router(config)#exit
```

ルーターを終了し、再起動する

14. ターミナルにて以下のコマンドを入力する

```cs
Router>enable
Router#conf t
Router(config)#interface FastEthenet 0/0
Router(config)#ip address 192.255.255.2 255.255.255.0
```
パソコンと、ルーターが同じネットワークにあるように設定する

15. ターミナルにて、以下のコマンドを入力する

```cs
Router#copy flash tftp
```

eraseとか聞いてきたらコマンド間違っているのでctr+cで抜けよう！
間違うとIOSファイルが消える

16. ターミナル２でTFTPサーバを終了する

```cs
sudo launchctl unload -w /System/Library/LaunchDaemons/tftp.plist
```